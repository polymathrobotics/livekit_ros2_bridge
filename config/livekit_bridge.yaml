# Default configuration for the livekit_ros2_bridge node.
#
# This file is intended to be loaded via the packaged launch file:
#   ros2 launch livekit_ros2_bridge livekit_bridge.launch.yaml
#
# LiveKit connection values are sourced from environment variables via
# launch substitutions. Bridge access control is configured here as ROS params.

livekit_bridge:
  ros__parameters:
    # LiveKit connection (env-driven)
    livekit.url: "$(env LIVEKIT_URL)"
    livekit.room: "$(env LIVEKIT_ROOM)"
    livekit.identity: "$(env LIVEKIT_IDENTITY '')"

    # Auth: set either LIVEKIT_TOKEN, or LIVEKIT_API_KEY + LIVEKIT_API_SECRET.
    livekit.token: "$(env LIVEKIT_TOKEN '')"
    livekit.api_key: "$(env LIVEKIT_API_KEY '')"
    livekit.api_secret: "$(env LIVEKIT_API_SECRET '')"

    # Connection tuning (static defaults)
    livekit.token_ttl_seconds: 3600
    livekit.reconnect.initial_backoff_ms: 500
    livekit.reconnect.max_backoff_ms: 10000

    # Bridge access policy (default-deny).
    #
    # IMPORTANT: The node refuses to start unless you configure at least one allowlist.
    #
    # Examples:
    # access.static.subscribe.allow: ["/user/*"]  # ["*"] allows all subscriptions
    # access.static.publish.allow: ["/user/*"]
    # access.static.service.allow: ["/example/service"]
    access.static.subscribe.type_deny:
      - sensor_msgs/msg/Image
      - sensor_msgs/msg/CompressedImage
      - sensor_msgs/msg/PointCloud2
    subscribe.max_total_subscriptions: 128
    subscribe.max_subscriptions_per_participant: 32

    publish.max_topics: 50

    service.timeout_ms: 2000
    service.max_inflight_per_participant: 4
